# Visual C++ Redistributable в установщике

## Что включено

Установщик `1CUpdaterAgentInstaller.exe` теперь включает Visual C++ Redistributable 2015-2022 x64.

## Как это работает

1. **Проверка установки**: При запуске установщик проверяет, установлен ли уже VC++ Redistributable на системе
2. **Автоматическая установка**: Если VC++ Redistributable не найден, установщик:
   - Сначала пытается извлечь встроенный установщик из ресурсов
   - Если встроенный установщик не найден, скачивает его с официального сайта Microsoft
   - Устанавливает VC++ Redistributable в тихом режиме (`/quiet /norestart`)
3. **Продолжение установки**: После установки VC++ Redistributable установщик продолжает установку агента

## Преимущества

- ✅ Не требует ручной установки VC++ Redistributable
- ✅ Решает проблему "параллельная конфигурация неправильна"
- ✅ Работает даже на чистых системах без установленных компонентов Visual C++
- ✅ Автоматическая загрузка, если встроенный файл отсутствует

## Технические детали

- **Встроенный файл**: `Resources\vc_redist.x64.exe` (включен как EmbeddedResource)
- **URL для скачивания**: `https://aka.ms/vs/17/release/vc_redist.x64.exe`
- **Размер встроенного файла**: ~25-30 MB
- **Проверка установки**: Через реестр и WMI

## Обновление VC++ Redistributable

Если нужно обновить версию VC++ Redistributable:

1. Скачайте новую версию с https://aka.ms/vs/17/release/vc_redist.x64.exe
2. Замените файл `Resources\vc_redist.x64.exe`
3. Пересоберите установщик

## Логирование

Все действия по установке VC++ Redistributable записываются в лог установки, который создается рядом с установщиком.


