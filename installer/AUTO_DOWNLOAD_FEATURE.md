# Автоматическое скачивание файла агента

## Что добавлено

Установщик теперь **автоматически скачивает** файл `1CUpdaterAgent.exe` с сервера, если он не найден локально.

## Как это работает

1. **Поиск локально**: При запуске установщик ищет файл `1CUpdaterAgent.exe`:
   - В той же папке, что и установщик
   - В подпапках `bin\Release\net8.0` и `bin\Debug\net8.0`

2. **Автоматическое скачивание**: Если файл не найден локально:
   - Установщик автоматически скачивает его с сервера по URL: `{ServerUrl}/api/agent/download-exe`
   - Файл сохраняется в ту же папку, что и установщик
   - Процесс отображается в логе установки

3. **Обработка ошибок**: Если скачивание не удалось:
   - Показывается подробное сообщение об ошибке
   - Предлагается либо исправить URL сервера, либо поместить файл вручную

## Преимущества

- ✅ **Не нужно вручную скачивать файл агента** - установщик делает это автоматически
- ✅ **Упрощенная установка** - достаточно только установщика и правильного URL сервера
- ✅ **Актуальная версия** - всегда скачивается последняя версия с сервера
- ✅ **Подробное логирование** - все действия записываются в лог

## Требования

- Сервер должен быть доступен по указанному URL
- На сервере должен быть собран файл `1CUpdaterAgent.exe`
- Эндпоинт `/api/agent/download-exe` должен быть доступен (теперь публичный, без авторизации)

## Пример использования

1. Скачайте только установщик `1CUpdaterAgentInstaller.exe`
2. Запустите его от имени администратора
3. Введите ID ПК и URL сервера (например: `http://192.168.1.100:3001`)
4. Нажмите "Установить"
5. Установщик автоматически:
   - Скачает файл агента с сервера (если не найден локально)
   - Установит VC++ Redistributable (если требуется)
   - Установит и запустит службу агента

## Логирование

Все действия по скачиванию записываются в лог файл, который создается рядом с установщиком:
- `1CUpdaterAgentInstaller-Install-YYYYMMDD-HHMMSS.log`


