# Версия 3.0 - Выбор папки установки и удаление агента

## Новые возможности

### 1. Выбор папки установки
- **Поле "Папка установки"** в установщике
- **Кнопка "Обзор..."** для выбора папки через диалог
- **Значение по умолчанию:** `C:\Program Files\1CUpdaterAgent`
- Пользователь может выбрать любую папку для установки агента

### 2. Удаление агента
- **Кнопка "Удалить"** в установщике
- Полное удаление агента:
  - Остановка и удаление службы Windows
  - Удаление файлов агента из папки установки
  - Удаление конфигурации из `C:\ProgramData\1CUpdaterAgent`
- Подтверждение перед удалением
- Подробное логирование процесса удаления

### 3. Улучшения в веб-интерфейсе
- **Кнопка "Удалить"** для каждого ПК с установленным агентом
- Предупреждение при попытке переустановки существующего агента
- Инструкции по использованию функции удаления

## Интерфейс установщика

### Поля ввода:
1. **ID ПК** - числовой идентификатор ПК
2. **URL сервера** - адрес сервера управления
3. **Папка установки** - путь для установки агента (с кнопкой "Обзор...")

### Кнопки:
1. **Установить** - установка/переустановка агента
2. **Удалить** - полное удаление агента
3. **Отмена** - закрытие установщика

## Процесс установки

1. Пользователь вводит ID ПК и URL сервера
2. Выбирает папку установки (или оставляет по умолчанию)
3. Нажимает "Установить"
4. Установщик:
   - Скачивает агента с сервера (если не найден локально)
   - Копирует агента в выбранную папку
   - Создает службу Windows
   - Создает конфигурацию
   - Запускает службу

## Процесс удаления

1. Пользователь нажимает "Удалить"
2. Подтверждает удаление
3. Установщик:
   - Останавливает службу
   - Удаляет службу Windows
   - Удаляет файлы агента из папки установки
   - Удаляет конфигурацию
   - Показывает результат

## Логирование

Все действия (установка и удаление) логируются в файл рядом с установщиком:
- `1CUpdaterAgentInstaller-Install-YYYYMMDD-HHMMSS.log` - для установки
- `1CUpdaterAgentInstaller-Install-YYYYMMDD-HHMMSS.log` - для удаления (тот же формат)

## Безопасность

- Удаление требует подтверждения
- Все действия требуют прав администратора
- Подробное логирование всех операций
- Проверка существования файлов перед удалением


