# Прямое логирование в EventLog

## Проблема

Логи из `ILogger<AgentService>` не попадали в EventLog, поэтому не было видно, что происходит в `ExecuteAsync` и `RegisterAgentAsync`.

## Решение

Добавлено **прямое логирование в EventLog** из критических точек:

1. **Конструктор AgentService** - логирует вызов конструктора с параметрами конфигурации
2. **ExecuteAsync** - логирует начало выполнения с параметрами конфигурации
3. **Ошибки PcId** - логирует ошибки в EventLog напрямую

## Что теперь будет в EventLog

После переустановки агента вы увидите:

1. **"Начало запуска службы 1C Updater Agent"** - из Program.Main
2. **"Host создан успешно, запуск службы..."** - из Program.Main
3. **"Вызов host.Run()..."** - из Program.Main (новое)
4. **"AgentService конструктор вызван. PcId=..., AgentId=..., ServerUrl=..."** - из конструктора (новое, прямое логирование)
5. **"=== ExecuteAsync ВЫЗВАН === PcId=..., AgentId=..., ServerUrl=..."** - из ExecuteAsync (новое, прямое логирование)
6. **"Агент инициализирован..."** - из ILogger
7. **"=== ExecuteAsync: Сервис агента запущен ==="** - из ILogger
8. **"Начало регистрации агента..."** - из ILogger
9. **"✅ Агент успешно зарегистрирован на сервере"** - из ILogger

## Преимущества

- ✅ Гарантированное логирование даже если ILogger не работает
- ✅ Видно, вызывается ли конструктор и ExecuteAsync
- ✅ Видно параметры конфигурации при запуске
- ✅ Ошибки логируются в EventLog напрямую

## Проверка

После переустановки агента:

```powershell
Get-EventLog -LogName Application -Source "1CUpdaterAgent" -Newest 30 | Format-List TimeGenerated, EntryType, Message
```

Должны быть видны все этапы, включая вызов конструктора и ExecuteAsync.


